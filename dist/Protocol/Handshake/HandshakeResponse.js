import{capabilitiesBase as r,capabilitiesExtended as o,capabilitiesMariaDB as s,defaultCollation as t}from"../Client.js";import{hashMySQLNativePassword as e}from"../Plugins/MySqlNativePassword.js";import{createUInt16LE as f,createUInt32LE as a,toNullTerminatedStringEscaped as i,toStringEncoded as n}from"../../Utils/BufferUtil.js";export function createHandshakeResponse(u,l,m,p){let d=void 0===m.password||""===m.password?Buffer.from([0]):n(e(u,m.password).toString("binary"));return Buffer.concat([f(r),f(o),a(p),Buffer.from([t]),Buffer.alloc(19),a(s),i(m.user),d,i(m.database),i(l.toString("binary"))])}