import{readDatetimeEncoded as t,readNullTerminatedString as e,readTimeEncoded as r}from"./BufferUtil.js";export class BufferConsumer{#t;#e;constructor(t,e=0){this.#e=0,this.#t=t,this.#e=e}at(t=0){return this.#t.readUInt8(this.#e+t)}readUInt(t=1){let e=this.#t.readUIntLE(this.#e,t);return this.#e+=t,e}readInt(t=1){let e=this.#t.readIntLE(this.#e,t);return this.#e+=t,e}readUBigInt(){let t=this.#t.readBigUInt64LE(this.#e);return this.#e+=8,t}readBigInt(){let t=this.#t.readBigInt64LE(this.#e);return this.#e+=8,t}readIntEncoded(){let t=this.#t.readUInt8(this.#e++);if(0===t)return 0;if(251===t)return null;if(252===t)return this.readUInt(2);if(253===t)return this.readUInt(3);if(254===t){let t=this.#t.readBigUInt64LE(this.#e);return this.#e+=8,t}return t}readBoolean(){return!!this.#t.readInt8(this.#e++)}readNullTerminatedString(){let t=e(this.#t,this.#e);return this.#e+=t.length+1,t}readString(t,e=!1){let r=this.#t.subarray(this.#e,this.#e+t);return this.#e+=t+ +e,r}readStringEncoded(){let t=this.readIntEncoded();if(null===t)return null;if(0===t)return Buffer.from("");let e=this.#t.subarray(this.#e,this.#e+Number(t));return this.#e+=e.length,e}readDatetimeEncoded(){return t(this.slice(this.at()+1))}readTimeEncoded(){return r(this.slice(this.at()+1))}slice(t){return this.#t.subarray(this.#e,this.#e+=t)}skip(t=1){return this.#e+=t,this}skipStringEncoded(){let t=this.readIntEncoded();return null===t||0===t||(this.#e+=Number(t)),this}consumed(){return this.#e===this.#t.length}}